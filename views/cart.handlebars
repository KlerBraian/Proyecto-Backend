<main>
    <h1 class="titulo" id="titulo">Carrito de Compras</h1>
    <a href="/">Volver</a>

    {{#if products.length}}
    <div class="productos-cart">
        {{#each products}}
        <div class="producto">
            <h3 class="producto-title">{{product.title}}</h3>
            <img src="{{product.thumbnail}}" alt="">
            <p class="producto-price">${{product.price}}</p>
            <p class="producto-categoria">Categoría: {{product.category}}</p>
            <p class="producto-description">{{product.description}}</p>
            <p class="producto-cantidad">Cantidad: {{quantity}}</p>
            <p class="producto-subtotal">Subtotal: ${{subtotal}}</p> <!-- Mostrar subtotal de cada producto -->
          
      {{!-- <form action="/api/carts/{{cartId}}" method="POST" class="eliminar-carrito"></form>
                 <input type="number" name="quantity" min="1" value="{{quantity}}" />
            <!-- Botón para actualizar la cantidad -->
            <button type="button" data-product-id="{{product._id}}" onclick="updateProductQuantity()">Modificar Carrito</button>
             </form> --}}
        </div>
        {{/each}}
        <div class="total-carrito">
            <p>Total del carrito: ${{subtotalTotal}}</p> <!-- Mostrar subtotal total -->
        </div>
         <button onclick="emptyCart('{{cartId}}')">Vaciar Carrito</button>
    </div>
    {{else}}
    <p>No hay productos en el carrito.</p>
    {{/if}}
</main>
<script>
// Función para vaciar el carrito
function emptyCart(id_cart) {
    console.log("ID del carrito:", id_cart);

    fetch(`/api/carts/${id_cart}`, {
        method: "DELETE"
    })
    .then(response => response.json())
    .then(data => {
        console.log("Carrito vaciado:", data);
        // Acá puedes actualizar el DOM para reflejar que el carrito está vacío
        location.reload(); // Recargar la página para reflejar los cambios
    })
    .catch(error => console.error("Error:", error));
}
</script>